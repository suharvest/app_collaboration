## 部署前准备

请确认你已准备好以下设备：

| 设备 | 数量 | 说明 |
|------|------|------|
| SenseCAP T1000 追踪器 | 至少 1 台 | 用于测试 |
| BC01 蓝牙信标 | 三角定位 3+ 个，区域定位 1+ 个 | 根据场景选择 |
| SenseCAP M2 网关 | 1 台 | 或其他兼容 LoRaWAN 网关 |
| 电脑 | 1 台 | 已安装 Docker，用于运行定位服务 |

## 套餐: 入门套件 {#starter}

## 步骤 1: 部署 BLE 信标 {#beacons type=manual required=true}

### 安装信标

**根据定位精度选择安装数量**：
- 三角定位（米级精度）：每个区域至少 3 个信标
- 区域定位（判断在不在）：每个区域 1 个信标即可

**安装要求**：
- 安装高度：2.5-3 米（避免被人体遮挡）
- 信标间距：10-15 米
- 避免安装在金属表面附近

**安装步骤**：
1. 规划信标位置，画一张简单的布局图
2. 用双面胶或螺丝固定信标
3. 记录每个信标的 MAC 地址和安装位置（后面配置要用）

> MAC 地址印在信标背面，格式如 `AA:BB:CC:DD:EE:FF`

### 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| 信标灯不亮 | 电池没电 | 更换 CR2477 电池 |
| 定位不准 | 信标太少或间距太大 | 增加信标密度 |
| 追踪器扫不到信标 | 信标安装太高或有遮挡 | 调整安装位置 |

---

## 步骤 2: 设置 LoRaWAN 网关 {#gateway type=manual required=true}

### 网关配置

**安装步骤**：
1. 网关通电，连接网络（以太网或 WiFi）
2. 使用 SenseCraft App 扫码绑定网关
3. 等待 LED 常亮绿色，表示网关就绪

**放置建议**：
- 放在场地中央位置，覆盖范围最大
- 室内覆盖半径约 500 米，室外可达 2 公里
- 避免放在金属柜子里或地下室

### 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| LED 不亮 | 电源问题 | 检查电源适配器和线缆 |
| LED 红色闪烁 | 网络未连接 | 检查网线或 WiFi 配置 |
| App 扫码失败 | 网关未联网 | 确保网关已连接互联网 |
| 追踪器数据不上报 | 频段不匹配 | 确认网关和追踪器使用相同频段（如 CN470） |

---

## 步骤 3: 部署定位应用程序 {#app_server type=docker_deploy required=true config=devices/app_local.yaml}

### 部署目标: 本机部署 {#app_server_local config=devices/app_local.yaml default=true}

### 本机部署

将室内定位应用程序部署到您的本地电脑。

**前提条件**：
- Docker Desktop 已安装并运行
- 端口 5173 可用

点击下方的"部署"按钮，等待服务启动完成。

### 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| 部署失败 | Docker 未运行 | 启动 Docker Desktop |
| 端口被占用 | 其他程序占用 5173 | 关闭占用程序或修改端口 |
| 网页打不开 | 服务未启动完成 | 等待几分钟，刷新页面 |

### 部署目标: 远程部署 {#app_server_remote config=devices/app_remote.yaml}

### 远程部署

通过 SSH 将室内定位应用程序部署到远程服务器。

**开始之前**：
1. 将目标设备连接到网络
2. 获取设备 IP 地址
3. 获取 SSH 凭据（用户名/密码）
4. 确保远程服务器已安装 Docker

在下方填写服务器信息，然后点击"部署"按钮。

### 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| SSH 连接失败 | IP 或凭据错误 | 检查 IP 地址和用户名密码 |
| 部署失败 | 远程服务器无 Docker | 在远程服务器上安装 Docker |
| 网页打不开 | 防火墙阻止 | 开放远程服务器 5173 端口 |

---

## 步骤 4: 配置并激活追踪器 {#tracker type=manual required=true}

### 配置追踪器

**开机和入网**：
1. 长按电源键 3 秒开机，绿灯闪烁表示正在入网
2. 入网成功后绿灯熄灭，追踪器进入工作状态

**使用 SenseCraft App 配置**：
1. 打开 SenseCraft App，蓝牙连接追踪器
2. 设置工作模式为"BLE 扫描"
3. 选择正确的 LoRaWAN 区域（如 CN470、US915、EU868）
4. 保存配置

**验证定位**：
1. 走到信标附近
2. 按追踪器按钮触发上报
3. 在定位应用网页上查看位置是否正确显示

### 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| 开机后一直闪烁 | 入网失败 | 检查网关是否在线，频段是否匹配 |
| 网页上看不到追踪器 | Webhook 未配置 | 检查网络服务器的 Webhook 是否指向定位应用 |
| 位置不更新 | 追踪器休眠 | 按按钮触发上报，或调整上报间隔 |
| 位置显示错误 | 信标坐标配置错误 | 检查网页上信标的位置标记是否正确 |

---

## 套餐: 标准配置 {#standard}

## 步骤 1: 部署 BLE 信标 {#beacons type=manual required=true}

### 安装信标

**根据定位精度选择安装数量**：
- 三角定位（米级精度）：每个区域至少 3 个信标
- 区域定位（判断在不在）：每个区域 1 个信标即可

**安装要求**：
- 安装高度：2.5-3 米（避免被人体遮挡）
- 信标间距：10-15 米
- 避免安装在金属表面附近

**安装步骤**：
1. 规划信标位置，画一张简单的布局图
2. 用双面胶或螺丝固定信标
3. 记录每个信标的 MAC 地址和安装位置（后面配置要用）

> MAC 地址印在信标背面，格式如 `AA:BB:CC:DD:EE:FF`

### 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| 信标灯不亮 | 电池没电 | 更换 CR2477 电池 |
| 定位不准 | 信标太少或间距太大 | 增加信标密度 |
| 追踪器扫不到信标 | 信标安装太高或有遮挡 | 调整安装位置 |

---

## 步骤 2: 设置 LoRaWAN 网关 {#gateway type=manual required=true}

### 网关配置

**安装步骤**：
1. 网关通电，连接网络（以太网或 WiFi）
2. 使用 SenseCraft App 扫码绑定网关
3. 等待 LED 常亮绿色，表示网关就绪

**放置建议**：
- 放在场地中央位置，覆盖范围最大
- 室内覆盖半径约 500 米，室外可达 2 公里
- 避免放在金属柜子里或地下室

### 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| LED 不亮 | 电源问题 | 检查电源适配器和线缆 |
| LED 红色闪烁 | 网络未连接 | 检查网线或 WiFi 配置 |
| App 扫码失败 | 网关未联网 | 确保网关已连接互联网 |
| 追踪器数据不上报 | 频段不匹配 | 确认网关和追踪器使用相同频段（如 CN470） |

---

## 步骤 3: 部署定位应用程序 {#app_server type=docker_deploy required=true config=devices/app_local.yaml}

### 部署目标: 本机部署 {#app_server_local config=devices/app_local.yaml default=true}

### 本机部署

将室内定位应用程序部署到您的本地电脑。

**前提条件**：
- Docker Desktop 已安装并运行
- 端口 5173 可用

点击下方的"部署"按钮，等待服务启动完成。

### 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| 部署失败 | Docker 未运行 | 启动 Docker Desktop |
| 端口被占用 | 其他程序占用 5173 | 关闭占用程序或修改端口 |
| 网页打不开 | 服务未启动完成 | 等待几分钟，刷新页面 |

### 部署目标: 远程部署 {#app_server_remote config=devices/app_remote.yaml}

### 远程部署

通过 SSH 将室内定位应用程序部署到远程服务器。

**开始之前**：
1. 将目标设备连接到网络
2. 获取设备 IP 地址
3. 获取 SSH 凭据（用户名/密码）
4. 确保远程服务器已安装 Docker

在下方填写服务器信息，然后点击"部署"按钮。

### 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| SSH 连接失败 | IP 或凭据错误 | 检查 IP 地址和用户名密码 |
| 部署失败 | 远程服务器无 Docker | 在远程服务器上安装 Docker |
| 网页打不开 | 防火墙阻止 | 开放远程服务器 5173 端口 |

---

## 步骤 4: 配置并激活追踪器 {#tracker type=manual required=true}

### 配置追踪器

**开机和入网**：
1. 长按电源键 3 秒开机，绿灯闪烁表示正在入网
2. 入网成功后绿灯熄灭，追踪器进入工作状态

**使用 SenseCraft App 配置**：
1. 打开 SenseCraft App，蓝牙连接追踪器
2. 设置工作模式为"BLE 扫描"
3. 选择正确的 LoRaWAN 区域（如 CN470、US915、EU868）
4. 保存配置

**验证定位**：
1. 走到信标附近
2. 按追踪器按钮触发上报
3. 在定位应用网页上查看位置是否正确显示

### 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| 开机后一直闪烁 | 入网失败 | 检查网关是否在线，频段是否匹配 |
| 网页上看不到追踪器 | Webhook 未配置 | 检查网络服务器的 Webhook 是否指向定位应用 |
| 位置不更新 | 追踪器休眠 | 按按钮触发上报，或调整上报间隔 |
| 位置显示错误 | 信标坐标配置错误 | 检查网页上信标的位置标记是否正确 |

---

## 套餐: 企业版 {#enterprise}

## 步骤 1: 部署 BLE 信标 {#beacons type=manual required=true}

### 安装信标

**根据定位精度选择安装数量**：
- 三角定位（米级精度）：每个区域至少 3 个信标
- 区域定位（判断在不在）：每个区域 1 个信标即可

**安装要求**：
- 安装高度：2.5-3 米（避免被人体遮挡）
- 信标间距：10-15 米
- 避免安装在金属表面附近

**安装步骤**：
1. 规划信标位置，画一张简单的布局图
2. 用双面胶或螺丝固定信标
3. 记录每个信标的 MAC 地址和安装位置（后面配置要用）

> MAC 地址印在信标背面，格式如 `AA:BB:CC:DD:EE:FF`

### 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| 信标灯不亮 | 电池没电 | 更换 CR2477 电池 |
| 定位不准 | 信标太少或间距太大 | 增加信标密度 |
| 追踪器扫不到信标 | 信标安装太高或有遮挡 | 调整安装位置 |

---

## 步骤 2: 设置 LoRaWAN 网关 {#gateway type=manual required=true}

### 网关配置

**安装步骤**：
1. 网关通电，连接网络（以太网或 WiFi）
2. 使用 SenseCraft App 扫码绑定网关
3. 等待 LED 常亮绿色，表示网关就绪

**放置建议**：
- 放在场地中央位置，覆盖范围最大
- 室内覆盖半径约 500 米，室外可达 2 公里
- 避免放在金属柜子里或地下室

### 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| LED 不亮 | 电源问题 | 检查电源适配器和线缆 |
| LED 红色闪烁 | 网络未连接 | 检查网线或 WiFi 配置 |
| App 扫码失败 | 网关未联网 | 确保网关已连接互联网 |
| 追踪器数据不上报 | 频段不匹配 | 确认网关和追踪器使用相同频段（如 CN470） |

---

## 步骤 3: 部署定位应用程序 {#app_server type=docker_deploy required=true config=devices/app_local.yaml}

### 部署目标: 本机部署 {#app_server_local config=devices/app_local.yaml default=true}

### 本机部署

将室内定位应用程序部署到您的本地电脑。

**前提条件**：
- Docker Desktop 已安装并运行
- 端口 5173 可用

点击下方的"部署"按钮，等待服务启动完成。

### 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| 部署失败 | Docker 未运行 | 启动 Docker Desktop |
| 端口被占用 | 其他程序占用 5173 | 关闭占用程序或修改端口 |
| 网页打不开 | 服务未启动完成 | 等待几分钟，刷新页面 |

### 部署目标: 远程部署 {#app_server_remote config=devices/app_remote.yaml}

### 远程部署

通过 SSH 将室内定位应用程序部署到远程服务器。

**开始之前**：
1. 将目标设备连接到网络
2. 获取设备 IP 地址
3. 获取 SSH 凭据（用户名/密码）
4. 确保远程服务器已安装 Docker

在下方填写服务器信息，然后点击"部署"按钮。

### 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| SSH 连接失败 | IP 或凭据错误 | 检查 IP 地址和用户名密码 |
| 部署失败 | 远程服务器无 Docker | 在远程服务器上安装 Docker |
| 网页打不开 | 防火墙阻止 | 开放远程服务器 5173 端口 |

---

## 步骤 4: 配置并激活追踪器 {#tracker type=manual required=true}

### 配置追踪器

**开机和入网**：
1. 长按电源键 3 秒开机，绿灯闪烁表示正在入网
2. 入网成功后绿灯熄灭，追踪器进入工作状态

**使用 SenseCraft App 配置**：
1. 打开 SenseCraft App，蓝牙连接追踪器
2. 设置工作模式为"BLE 扫描"
3. 选择正确的 LoRaWAN 区域（如 CN470、US915、EU868）
4. 保存配置

**验证定位**：
1. 走到信标附近
2. 按追踪器按钮触发上报
3. 在定位应用网页上查看位置是否正确显示

### 故障排查

| 问题 | 可能原因 | 解决方法 |
|------|---------|---------|
| 开机后一直闪烁 | 入网失败 | 检查网关是否在线，频段是否匹配 |
| 网页上看不到追踪器 | Webhook 未配置 | 检查网络服务器的 Webhook 是否指向定位应用 |
| 位置不更新 | 追踪器休眠 | 按按钮触发上报，或调整上报间隔 |
| 位置显示错误 | 信标坐标配置错误 | 检查网页上信标的位置标记是否正确 |

---

# 部署完成

## 部署成功！

室内定位应用程序现已运行。

### 访问定位仪表板

打开浏览器访问：**http://localhost:5173**

**默认账号**：
- 用户名：`admin`
- 密码：`83EtWJUbGrPnQjdCqyKq`

> 首次登录后请立即修改密码！

### 配置地图和信标

1. **上传楼层地图**：在"地图设置"中上传您的楼层平面图
2. **标记信标位置**：点击地图，输入信标 MAC 地址，标记每个信标的安装位置
3. **配置 Webhook**：在 LoRaWAN 网络服务器（SenseCraft Data 或 ChirpStack）中，将 Webhook 地址设置为：
   ```
   http://您的电脑IP:5173/api/webhook
   ```

### 验证定位

1. 走到信标附近，按追踪器按钮触发上报
2. 在网页地图上查看追踪器位置是否正确显示
3. 如果位置不准，检查信标坐标是否标记正确

### 需要帮助？

- [Wiki 文档](https://wiki.seeedstudio.com/cn/solutions/indoor-positioning-bluetooth-lorawan-tracker/)
- [GitHub 仓库](https://github.com/Seeed-Solution/Solution_IndoorPositioning_H5)
