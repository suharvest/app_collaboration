version: "1.0"
id: display_local
name: Display Service (Local)
name_zh: 投屏服务（本机）
type: docker_local

detection:
  method: local
  requirements:
    - docker_installed
    - docker_running

docker:
  compose_file: assets/docker/docker-compose.yml

  environment:
    TZ: Asia/Shanghai
    RD_DEVICE_NAME: "Xiaozhi Display"
    RD_NO_AUDIO: "false"

  options:
    project_name: xiaozhi_display
    remove_orphans: true

  services:
    - name: xiaozhi-display
      port: 8765
      health_check_endpoint: /
      required: true

  images:
    - name: sensecraft-missionpack.seeed.cn/solution/xiaozhi-display:latest
      required: true

pre_checks:
  - type: docker_version
    min_version: "20.0"
    description: Check Docker version

steps:
  - id: pull_images
    name: Pull Docker Images
    name_zh: 拉取 Docker 镜像
    description: Download container image from registry
    description_zh: 从镜像仓库下载容器镜像
    optional: false
    default: true

  - id: start_services
    name: Start Services
    name_zh: 启动服务
    description: Launch Docker container
    description_zh: 启动 Docker 容器
    optional: false
    default: true

  - id: health_check
    name: Health Check
    name_zh: 健康检查
    description: Verify service is running correctly
    description_zh: 验证服务运行正常
    optional: false
    default: true

post_deployment:
  open_browser: true
  url: "http://localhost:8765"
