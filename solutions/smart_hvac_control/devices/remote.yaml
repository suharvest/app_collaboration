version: "1.0"
id: remote
name: Remote Device
name_zh: 远程设备
type: docker_remote

detection:
  method: network_scan
  manual_entry: true
  requirements:
    - docker_installed
    - docker_running

ssh:
  port: 22
  default_user: recomputer
  auth_methods:
    - password
    - key
  connection_timeout: 30
  command_timeout: 600

docker_remote:
  compose_file: assets/docker/docker-compose.yml
  compose_dir: assets/docker
  remote_path: /home/{{username}}/smart_hvac_control

  environment:
    TZ: Asia/Shanghai
    OPC_UA_SERVER: "{{opc_ua_server}}"

  options:
    project_name: missionpack_knn
    remove_orphans: true

  services:
    - name: app
      port: 8280
      health_check_endpoint: /api/v1/health
      required: true

user_inputs:
  - id: host
    name: Device IP
    name_zh: 设备 IP 地址
    type: text
    required: true
    placeholder: "192.168.1.100"
    description: IP address of the target device
    description_zh: 目标设备的 IP 地址
    validation:
      pattern: "^((25[0-5]|(2[0-4]|1\\d|[1-9]|)\\d)\\.?\\b){4}$"
      message: Please enter a valid IP address

  - id: username
    name: SSH Username
    name_zh: SSH 用户名
    type: text
    default: recomputer
    required: true
    description: SSH login username
    description_zh: SSH 登录用户名

  - id: password
    name: SSH Password
    name_zh: SSH 密码
    type: password
    required: true
    description: SSH login password
    description_zh: SSH 登录密码

  - id: opc_ua_server
    name: OPC-UA Server Address
    name_zh: OPC-UA 服务器地址
    type: text
    default: "opc.tcp://localhost:4841"
    placeholder: "opc.tcp://192.168.1.100:4840"
    description: OPC-UA server address (use default for built-in simulator)
    description_zh: OPC-UA 服务器地址（使用默认值连接内置模拟器）
    required: false

# Pre-checks removed - Docker will be checked on remote device by deployer
# pre_checks:
#   - type: docker_version
#     min_version: "20.0"
#     description: Check Docker version

post_deployment:
  open_browser: true
  url: "http://{{host}}:8280"
